<html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>watchman | A file watching service</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="watchman | A file watching service"><meta property="og:type" content="website"><meta property="og:url" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;watchman&#x2f;index.html"><meta property="og:image" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;watchman&#x2f;favicon.png"><meta property="og:description" content="A file watching service"><link rel="shortcut icon" href="&#x2f;watchman&#x2f;img&#x2f;favicon.png"><link rel="stylesheet" href="&#x2f;watchman&#x2f;css&#x2f;watchman.css"><script type="text&#x2f;javascript" src="&#x2f;&#x2f;use.typekit.net&#x2f;vqa1hcx.js"></script><script type="text&#x2f;javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="&#x2f;watchman&#x2f;">watchman</a><ul class="nav-site"><li><a href="&#x2f;watchman&#x2f;docs&#x2f;install.html" class="active">docs</a></li><li><a href="&#x2f;watchman&#x2f;support.html" class="">support</a></li><li><a href="http:&#x2f;&#x2f;github.com&#x2f;facebook&#x2f;watchman" class="">github</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Installation</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;install.html">Installation</a></li></ul></div><div class="nav-docs-section"><h3>Invocation</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cli-options.html">Command Line</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;config.html">Configuration Files</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;socket-interface.html">Socket Interface</a></li></ul></div><div class="nav-docs-section"><h3>Commands</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;clock.html">clock</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;find.html">find</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;get-config.html">get-config</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;get-sockname.html">get-sockname</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;log.html">log</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;log-level.html">log-level</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;query.html">query</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;shutdown-server.html">shutdown-server</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;since.html">since</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;subscribe.html">subscribe</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger.html">trigger</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger-del.html">trigger-del</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger-list.html">trigger-list</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;unsubscribe.html">unsubscribe</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;version.html">version</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch.html">watch</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-del.html">watch-del</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-list.html">watch-list</a></li></ul></div><div class="nav-docs-section"><h3>Queries</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;clockspec.html">Clockspec</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;file-query.html">File Queries</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;simple-query.html">Simple Pattern Syntax</a></li></ul></div><div class="nav-docs-section"><h3>Internals</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;bser.html">BSER Binary Protocol</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;casefolding.html">Case-Insensitivity</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;contributing.html">Contributing</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cookies.html">Query Synchronization</a></li></ul></div><div class="nav-docs-section"><h3>Troubleshooting</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;troubleshooting.html">Troubleshooting</a></li></ul></div></div><div class="inner-content"><h1>watch-project</h1><div><p>Requests that the <em>project</em> containing the requested dir is watched for
changes.
Watchman will track all files and dirs rooted at the <em>project</em> path.</p><h3><a class="anchor" name="rationale"></a>Rationale <a class="hash-link" href="#rationale">#</a></h3><p>With a proliferation of tools that wish to take advantage of
filesystem watching at different locations in a filesystem tree, it is
possible and likely for those tools to establish multiple overlapping
watches.</p><p>Most systems have a finite limit on the number of directories that can be
watched effectively; when that limit is exceeded the performance and
reliability of filesystem watching is degraded, sometimes to the point that it
ceases to function.</p><p>It is therefore desirable to avoid this situation and consolidate the
filesystem watches.  Watchman offers the <code>watch-project</code> command to allow
clients to opt-in to the watch consolidation behavior described below.</p><h3><a class="anchor" name="what-s-a-project-path"></a>What&#x27;s a project path? <a class="hash-link" href="#what-s-a-project-path">#</a></h3><p>A project is the logical root of a set of related files in a filesystem tree
and a good point at which to consolidate watches.  Tools such as
<a href="https:&#x2f;&#x2f;bitbucket.org&#x2f;facebook&#x2f;hgwatchman" target="_blank">hg-watchman</a> will most likely have
already established a watch at the root of a project, so any other tools that
wish to watch a sub-directory can do so for no additional cost if they re-use
that existing watch at a higher level in the filesystem tree.</p><p>The <code>watch-project</code> command uses a simple heuristic to locate the <em>project</em>
path that corresponds to a given path:</p><ol><li>The global configuration option
<a href="..&#x2f;config.html#project_root_files" target="_blank">project_root_files</a> defines a list
of files that, if present in a directory, indicate that that directory is
the root of a project tree.</li><li>The candidate directory is concatenated with each of <code>project_root_files</code>,
one by one and the resultant path is tested for existence.  If the
path exists then the candidate directory is the path that will be used
for the watch.  <code>watch-project</code> will thus behave as is the client
run the <code>watch</code> command with the <em>candidate</em> directory rather than the
original directory path.</li><li>If none of the <code>project_root_files</code> can be found in the candidate directory
then the parent of the candidate directory is used as a new candidate and
the process repeated at step 2 above.</li><li>If no candidates are found and the root of the filesystem is reached,
<code>watch-project</code> will fail.</li></ol><h3><a class="anchor" name="using-watch-project"></a>Using watch-project <a class="hash-link" href="#using-watch-project">#</a></h3><p>Assuming that <code>~&#x2f;www&#x2f;.hg</code> and <code>~&#x2f;www&#x2f;some&#x2f;child&#x2f;dir</code> both exist, then
the command:</p><div class="prism language-javascript">$ watchman watch<span class="token operator">-</span>project <span class="token operator">~</span><span class="token operator">&#x2f;</span>www<span class="token operator">&#x2f;</span>some<span class="token operator">&#x2f;</span>child<span class="token operator">&#x2f;</span>dir
<span class="token punctuation">{</span>
  <span class="token string">&quot;version&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;3.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;watch&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&#x2f;Users&#x2f;wez&#x2f;www&quot;</span>
<span class="token punctuation">}</span></div><p>establishes a watch on the <code>~&#x2f;www</code> directory because that is the directory
that contains a <code>project_root_file</code>.</p><p>As a client using <code>watch-project</code> it is important to observe the <code>watch</code>
element of the response; it identifies which directory is actually being
watched.  <strong>Any triggers, subscriptions or queries that the client issues
must be relative to the watched root to operate as expected.</strong></p><p>Note that, when you&#x27;re using the CLI, you can specify the root as
<code>~&#x2f;www&#x2f;some&#x2f;child&#x2f;dir</code> because the shell will resolve <code>~&#x2f;www&#x2f;some&#x2f;child&#x2f;dir</code> to
<code>&#x2f;Users&#x2f;wez&#x2f;www&#x2f;some&#x2f;child&#x2f;dir</code>, but when you use the JSON protocol, you are
responsible for supplying an absolute path.</p><p>JSON:</p><div class="prism language-javascript"><span class="token punctuation">[</span><span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#x2f;Users&#x2f;wez&#x2f;www&#x2f;some&#x2f;child&#x2f;dir&quot;</span><span class="token punctuation">]</span></div></div><div class="docs-prevnext"></div></div></section><footer class="wrap"><div class="right">© 2012-2014 Facebook Inc.</div></footer></div><div id="fb-root"></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-387204-10', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          </script></body></html>